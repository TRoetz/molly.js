define(["underscore","getAtoms","getBonds","Atom","Bond","three","detector","stats","trackballControls","keyboardState","fullScreen","windowResize"],function(e,t,n,r,i){return function(s,o,u){var a=parseInt(o.width)||parseInt(o.height)||window.innerWidth,f=parseInt(o.height)||parseInt(o.width)||window.innerHeight,l=o.stats||!1;Detector.webgl||Detector.addGetWebGLMessage();var c,h,p,d,v,m,g=new THREEx.KeyboardState,y=new THREE.Clock,b=function(){h=new THREE.Scene;var o=a,g=f,y=35,b=o/g,w=1,E=1e4;p=new THREE.PerspectiveCamera(y,b,w,E),h.add(p),p.position.set(0,150,400),p.lookAt(h.position),d=new THREE.WebGLRenderer({antialias:!0}),d.setSize(o,g),c=document.getElementById(s),c.appendChild(d.domElement),THREEx.WindowResize(d,p),THREEx.FullScreen.bindKey({charCode:"m".charCodeAt(0)}),v=new THREE.TrackballControls(p,d.domElement),v.zoomSpeed=.05,l&&(m=new Stats,m.domElement.style.zIndex=100,c.appendChild(m.domElement));var S=new THREE.PointLight(16316664);S.position.set(0,500,0),h.add(S);var x=new THREE.PointLight(16316664);x.position.set(0,-500,0),h.add(x);var T=new THREE.PointLight(13027014);T.position.set(0,0,-500),h.add(T);var N=new THREE.PointLight(13027014);N.position.set(0,0,500),h.add(N);var C=t(u),k=n(u);e.each(C,function(e){var t=new r(e);h.add(t)}),e.each(k,function(e){var t=new i(e,C);h.add(t)})},w=function(){requestAnimationFrame(w),S(),E()},E=function(){v.update(),l&&m.update()},S=function(){d.render(h,p)};b(),w()}});